-- =====================================
--  ROLES
-- =====================================
INSERT INTO rol (nombre)
SELECT 'ADMIN'
WHERE NOT EXISTS (SELECT 1 FROM rol WHERE nombre = 'ADMIN');

INSERT INTO rol (nombre)
SELECT 'CLIENTE'
WHERE NOT EXISTS (SELECT 1 FROM rol WHERE nombre = 'CLIENTE');

-- =====================================
--  USUARIOS
-- =====================================
INSERT INTO usuario (nombre, correo, contraseña, rol_id)
SELECT 'Administrador', 'admin@lafrance.com', 'admin123', 
       (SELECT id FROM rol WHERE nombre = 'ADMIN')
WHERE NOT EXISTS (SELECT 1 FROM usuario WHERE correo = 'admin@lafrance.com');

INSERT INTO usuario (nombre, correo, contraseña, rol_id)
SELECT 'Juan Pérez', 'juan.perez@gmail.com', '123456',
       (SELECT id FROM rol WHERE nombre = 'CLIENTE')
WHERE NOT EXISTS (SELECT 1 FROM usuario WHERE correo = 'juan.perez@gmail.com');

INSERT INTO usuario (nombre, correo, contraseña, rol_id)
SELECT 'María López', 'maria.lopez@gmail.com', '654321',
       (SELECT id FROM rol WHERE nombre = 'CLIENTE')
WHERE NOT EXISTS (SELECT 1 FROM usuario WHERE correo = 'maria.lopez@gmail.com');

-- =====================================
--  MENÚ
-- =====================================
INSERT INTO menu (nombre, descripcion, precio, disponible)
SELECT 'Croissant de Mantequilla', 'Croissant tradicional francés', 5.50, TRUE
WHERE NOT EXISTS (SELECT 1 FROM menu WHERE nombre = 'Croissant de Mantequilla');

INSERT INTO menu (nombre, descripcion, precio, disponible)
SELECT 'Quiche Lorraine', 'Tarta salada de jamón y queso', 8.90, TRUE
WHERE NOT EXISTS (SELECT 1 FROM menu WHERE nombre = 'Quiche Lorraine');

INSERT INTO menu (nombre, descripcion, precio, disponible)
SELECT 'Crème Brûlée', 'Postre con crema y azúcar caramelizado', 6.00, TRUE
WHERE NOT EXISTS (SELECT 1 FROM menu WHERE nombre = 'Crème Brûlée');

INSERT INTO menu (nombre, descripcion, precio, disponible)
SELECT 'Baguette con queso Brie', 'Pan artesanal con queso francés', 7.50, TRUE
WHERE NOT EXISTS (SELECT 1 FROM menu WHERE nombre = 'Baguette con queso Brie');

-- =====================================
--  RESERVAS
-- =====================================
INSERT INTO reserva (fecha, hora, cantidad_personas, usuario_id)
SELECT '2025-11-10', '19:00', 2, 
       (SELECT id FROM usuario WHERE correo = 'juan.perez@gmail.com')
WHERE NOT EXISTS (SELECT 1 FROM reserva WHERE fecha = '2025-11-10' AND hora = '19:00');

INSERT INTO reserva (fecha, hora, cantidad_personas, usuario_id)
SELECT '2025-11-11', '20:30', 4,
       (SELECT id FROM usuario WHERE correo = 'maria.lopez@gmail.com')
WHERE NOT EXISTS (SELECT 1 FROM reserva WHERE fecha = '2025-11-11' AND hora = '20:30');

-- =====================================
--  PEDIDOS
-- =====================================
INSERT INTO pedido (fecha_pedido, estado, total, usuario_id)
SELECT '2025-11-01', 'CONFIRMADO', 14.40, 
       (SELECT id FROM usuario WHERE correo = 'juan.perez@gmail.com')
WHERE NOT EXISTS (SELECT 1 FROM pedido WHERE fecha_pedido = '2025-11-01');

INSERT INTO pedido (fecha_pedido, estado, total, usuario_id)
SELECT '2025-11-02', 'PENDIENTE', 8.90, 
       (SELECT id FROM usuario WHERE correo = 'maria.lopez@gmail.com')
WHERE NOT EXISTS (SELECT 1 FROM pedido WHERE fecha_pedido = '2025-11-02');

-- =====================================
--  DETALLE DE PEDIDOS
-- =====================================
INSERT INTO detalle_pedido (cantidad, subtotal, menu_id, pedido_id)
SELECT 2, 11.00, 
       (SELECT id FROM menu WHERE nombre = 'Croissant de Mantequilla'),
       (SELECT id FROM pedido WHERE fecha_pedido = '2025-11-01')
WHERE NOT EXISTS (SELECT 1 FROM detalle_pedido WHERE pedido_id = (SELECT id FROM pedido WHERE fecha_pedido = '2025-11-01'));

INSERT INTO detalle_pedido (cantidad, subtotal, menu_id, pedido_id)
SELECT 1, 8.90,
       (SELECT id FROM menu WHERE nombre = 'Quiche Lorraine'),
       (SELECT id FROM pedido WHERE fecha_pedido = '2025-11-02')
WHERE NOT EXISTS (SELECT 1 FROM detalle_pedido WHERE pedido_id = (SELECT id FROM pedido WHERE fecha_pedido = '2025-11-02'));
